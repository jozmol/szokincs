<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KiejtÃ©s GyakorlÃ³ - Magyar - KÃ­nai</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin-top: 20px;
            color: #333;
        }
        
        header {
            background: linear-gradient(to right, #e52d27, #b31217);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }

        /* ÃšJ: BeÃ¡llÃ­tÃ¡sok szekciÃ³ */
        .settings-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }

        .settings-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .settings-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            align-items: center;
        }

        .select-wrapper {
            position: relative;
            min-width: 200px;
        }

        .word-count-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #2196F3;
            border-radius: 8px;
            background: white;
            color: #333;
            font-size: 1rem;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232196F3' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px;
        }

        .select-wrapper:after {
            content: 'â–¼';
            font-size: 12px;
            color: #2196F3;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .start-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-btn:hover {
            background: #3d8b40;
            transform: scale(1.05);
        }

        .practice-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .word-section {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .chinese-word {
            font-size: 4rem;
            margin-bottom: 10px;
            color: #e52d27;
            font-weight: bold;
        }
        
        .pinyin {
            font-size: 2rem;
            color: #666;
            margin-bottom: 20px;
        }
        
        .tts-info {
            background-color: #e3f2fd;
            padding: 10px;
            margin: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            text-align: center;
            border-left: 4px solid #2196F3;
        }
        
        .meaning {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 30px;
        }
        
        .recording-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .recording-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }
        
        .recording-btn:hover {
            background: #3d8b40;
            transform: scale(1.05);
        }
        
        .recording-btn.recording {
            background: #e52d27;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .feedback.good {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        
        .feedback.needs-work {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .listen-btn {
            background: #2196F3;
            color: white;
        }

        .listen-pinyin-btn {
            background: #9C27B0;
            color: white;
        }

        .next-btn {
            background: #FF9800;
            color: white;
        }

        .new-session-btn {
            background: #607D8B;
            color: white;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
        }
        
        .progress {
            margin-top: 20px;
            text-align: center;
            color: #666;
            font-size: 1.1rem;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }
        
        .hint-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .hint-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #1976d2;
        }

        .score-display {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .suggestion {
            font-style: italic;
            margin-top: 10px;
            color: #555;
        }
        
        .recording-status {
            margin-top: 10px;
            color: #666;
            font-size: 0.9rem;
        }

        .hidden {
            display: none;
        }
        
        @media (max-width: 600px) {
            .chinese-word {
                font-size: 3rem;
            }
            
            .pinyin {
                font-size: 1.5rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 100%;
                max-width: 250px;
            }

            .settings-row {
                flex-direction: column;
                gap: 10px;
            }

            .select-wrapper {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Pronunciation Practice</h1>
            <div class="subtitle">Practice pronouncing English words  <br> ç»ƒä¹ è‹±è¯­å•è¯çš„å‘éŸ³<br>å‘éŸ³ç»ƒä¹ </div>
        </header>
        <div class="tts-info">
            ğŸ”Š The read-aloud buttons use the system's built-in Text-to-Speech feature. 
            <br>When using for the first time, you must enable sound in the system if the reading function does not work.<br>
		On mobile devices, microphone access must be enabled for the browser to use it.<br>
            ğŸ”Š æœ—è®€æŒ‰éˆ•ä½¿ç”¨ç³»çµ±å…§å»ºçš„æ–‡å­—è½‰èªéŸ³åŠŸèƒ½ã€‚<br>é¦–æ¬¡ä½¿ç”¨æ™‚ï¼Œè‹¥æœ—è®€åŠŸèƒ½ç„¡æ³•é‹ä½œï¼Œæ‚¨å¿…é ˆåœ¨ç³»çµ±ä¸­å•Ÿç”¨è²éŸ³åŠŸèƒ½ã€‚
        </div>
<div class="progress hidden" id="progress-section">
                <div id="progress">0/0</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
            </div>
        <div class="content">
            <!-- ÃšJ: BeÃ¡llÃ­tÃ¡sok szekciÃ³ -->
            <div class="settings-section" id="settings-section">
                <div class="settings-title">
                    ğŸ¯ Choose how many words you want to practice<br>
                    ğŸ¯ é€‰æ‹©è¦ç»ƒä¹ çš„å•è¯æ•°é‡
                </div>
                <div class="settings-row">
                    <div class="select-wrapper">
                        <select class="word-count-select" id="word-count-select">
                            <option value="5">5 words - 5ä¸ªå•è¯</option>
                            <option value="10" selected>10 words - 10ä¸ªå•è¯</option>
                            <option value="20">20 words - 20ä¸ªå•è¯</option>
                            <option value="50">50 words - 50ä¸ªå•è¯</option>
                            <option value="100">100 words - 100ä¸ªå•è¯</option>
                            <option value="0">Total words - æ‰€æœ‰å•è¯</option>
                        </select>
                    </div>
                    <button class="start-btn" id="start-btn">
                        ğŸš€ Start exercise - å¼€å§‹ç»ƒä¹ 
                    </button>
                </div>

                <div class="practice-info" id="practice-info">
                    Total words: <span id="total-words">0</span> word / æ€»è®¡ï¼š
                </div>
            </div>

            <!-- MeglÃ©vÅ‘ gyakorlÃ³ szekciÃ³ -->
            <div class="word-section hidden" id="word-section">
                <div class="chinese-word" id="chinese-word">***</div>
                <div class="pinyin" id="pinyin">***</div>
                <div class="meaning" id="meaning">***</div>
            </div>
            
            <div class="recording-section hidden" id="recording-section">
                <button class="recording-btn" id="record-btn">
                    ğŸ¤ Click and talk - ç”¨åŒˆç‰™åˆ©è¯­è¯´å‡ºæ¥
                </button>
                <div class="recording-status" id="recording-status"></div>
                <div class="feedback" id="feedback"></div>
            </div>
            
            <div class="controls hidden" id="controls">
                <button class="control-btn listen-btn" id="listen-btn">
                    ğŸ”Š English reading<br>åŒˆç‰™åˆ©è¯­æœ—è¯»
                </button>
                <button class="control-btn listen-pinyin-btn" id="listen-pinyin-btn">
                    ğŸµ PinYin reading<br>æ‹¼éŸ³æœ—è¯»
                </button>
                <button class="control-btn next-btn" id="next-btn">
                   â¡ï¸ Next word<br>ä¸‹ä¸€ä¸ªè¯
                </button>
                <button class="control-btn new-session-btn" id="new-session-btn">
                    ğŸ”„ New exercise<br>æ–°çš„ç»ƒä¹ 
                </button>
            </div>
            
            
        </div>
    </div>

    <script>
        // SZÃ“TÃR - IDE JÃ–NNEK A 600+ SZAVAK
        const fullWordDictionary = [
            // Ide mÃ¡sold be a teljes 600+ szavas szÃ³tÃ¡rat
            // PÃ©lda szerkezet:
            
	{
                english: "thank you",
                pinyin: "thank you",
                meaning: "è°¢è°¢"
            },
            {
                english: "good day", 
                pinyin: "good day",
                meaning: "ä½ å¥½"
            },
            {
                english: "I love you",
                pinyin: "I love you", 
                meaning: "æˆ‘çˆ±ä½ "
            },
            
            
            // ... tovÃ¡bbi szavak
{
               english:"hello" ,
                pinyin: "hello",
                meaning: "ä½ å¥½"
                           },
            
            {
               english: "water",
                pinyin: "water",
                meaning: "æ°´", 
                            },
            {
               english: "mother",
                pinyin: "mother", 
                meaning: "å¦ˆå¦ˆ",
            },
            {
               english: "friend",
                pinyin: "friend",
                meaning: "æœ‹å‹",
            },
            {
               english: "school", 
                pinyin: "school",
                meaning: "å­¦æ ¡",
            },
            {
               english: "phone",
                pinyin: "phone",
                meaning: "ç”µè¯",
            },
            {
               english: "computer",
                pinyin: "computer",
                meaning: "ç”µè„‘",
            },
            {
                meaning: "æ±½è½¦",
                pinyin: "car",
               english: "car",
            },
            {
                meaning: "é£æœº",
                pinyin: "airplane",
               english: "airplane",
            },

	  {
               meaning: "æˆ‘å¯ä»¥åœ¨å“ªè£¡æ‰¾åˆ°å…¬è»Šç«™?",
               pinyin: "Where can I find the bus stop?",
              english:"Where can I find the bus stop?"
         	 },
	  	 {
		meaning: "æˆ‘å¯ä»¥åœ¨å“ªè£¡æ‰¾åˆ°ç«è»Šç«™?",
		pinyin: "Where can I find the train station?",
		english: "Where can I find the train station?"
            },
		{
      		meaning: "é…’åº—",
      		english: "hotel",
      		pinyin: "hotel",     
    	}, 
	{
      		meaning: "è¡Œæ",
      		english: "package",
      		"pinyin": "package",
    },
	{
      		meaning: "å‡ºç§Ÿè»Š",
      		english: "taxi",
      		"pinyin": "taxi",
    },
 	{
      		meaning: "åœ°éµ",
      		english: "subway",
      		pinyin: "subway"
    },
		{
      		"meaning": "èˆ¹",
      		english: "ship",
      		"pinyin": "ship",
    },

{		"meaning": "æ–¹å‘",
      		english: "direction",
      		"pinyin": "direction",
},
 {
      "meaning": "åŒ—",
      english: "north",
      "pinyin": "north",
}, 
{
      "meaning":"å—",
      english: "south",
      "pinyin": "south",
     
    },
{
      "meaning": "æ±",
      english: "east",
      "pinyin": "east",
    },
{
      "meaning": "è¥¿",
      english: "west",
      "pinyin": "west",
    },
{
      "meaning": "å·¦",
      english: "left",
      "pinyin": "left",
    },
 { 
      "meaning": "å³",
      english: "right",
      "pinyin": "right",
    },
{
      "meaning": "ç›´èµ°",
      english: "straight",
      "pinyin": "straight",
    },
{
      "meaning": "æ—…éŠ",
      english: "travel",
      "pinyin": "travel",
    },

{
      "meaning": "å°éŠ",
      english: "tour guide",
      "pinyin": "tour guide",
    },
   {
      "meaning": "æ™¯é»",
      english: "spectacle",
      "pinyin": "spectacle",
    },
{
      "meaning": "æµ·ç˜",
      english: "beach",
      "pinyin": "beach",
    },
{
      "meaning": "å±±",
      english: "mountain",
      "pinyin": "mountain",
    },
{
      "meaning": "æ¹–",
      english: "lake",
      "pinyin": "lake",
    },
{
      "meaning": "æ²³",
      english: "river",
      "pinyin": "river",
    },
{
      "meaning": "æ£®æ—",
      english: "forest",
      "pinyin": "forest",
    },

{
      "meaning": "åŸå¸‚",
      english: "town",
      "pinyin": "town",
    },
{
      "meaning": "é„‰æ‘",
      english: "countryside",
      "pinyin": "countryside",
    },
{
      "meaning": "è¡—é“",
      english: "street",
      "pinyin": "street",
    },
{
      "meaning": "ä¸»å¹¿åœº",
      english: "main square",
      "pinyin": "main square",
    },
   {
      "meaning": "å…¬åœ’",
      english: "park",
      "pinyin": "park",
    },
{
      "meaning": "åšç‰©é¤¨",
      english: "museum",
      "pinyin": "museum",
    },
    
{
      "meaning": "æ©‹",
      english: "bridge",
      "pinyin": "bridge",

    },
{
      "meaning": "éš§é“",
      english: "tunnel",
      "pinyin": "tunnel",
    },
{
      "meaning": "é«˜é€Ÿå…¬è·¯",
      english: "highway",
      "pinyin": "highway",
    },
{
      "meaning": "åŠ æ²¹ç«™",
      english: "benzinkÃºt",
      "pinyin": "benzinkÃºt",
    },
 {
      "meaning": "åœè»Šå ´",
      english: "car park",
      "pinyin": "car park",
    },
{
      "meaning": "ç§Ÿè»Š",
      english: "car rental",
      "pinyin": "car rental",
    },

        ];

        let currentWordIndex = 0;
        let selectedWords = [];
        let mediaRecorder;
        let audioChunks = [];
        let isRecording = false;
        let selectedWordCount = 5; // AlapÃ©rtelmezett

        // DOM elemek
        const settingsSection = document.getElementById('settings-section');
        const wordSection = document.getElementById('word-section');
        const recordingSection = document.getElementById('recording-section');
        const controlsSection = document.getElementById('controls');
        const progressSection = document.getElementById('progress-section');
        const chineseWordElement = document.getElementById('chinese-word');
        const pinyinElement = document.getElementById('pinyin');
        const meaningElement = document.getElementById('meaning');
        const recordButton = document.getElementById('record-btn');
        const listenButton = document.getElementById('listen-btn');
        const listenPinyinButton = document.getElementById('listen-pinyin-btn');
        const nextButton = document.getElementById('next-btn');
        const newSessionButton = document.getElementById('new-session-btn');
        const feedbackElement = document.getElementById('feedback');
        const progressElement = document.getElementById('progress');
        const progressFill = document.getElementById('progress-fill');
        const recordingStatus = document.getElementById('recording-status');
        const startButton = document.getElementById('start-btn');
        const wordCountSelect = document.getElementById('word-count-select');
        const totalWordsElement = document.getElementById('total-words');
        const practiceInfo = document.getElementById('practice-info');

        // InicializÃ¡lÃ¡s
        function init() {
            totalWordsElement.textContent = fullWordDictionary.length;
            updatePracticeInfo();
            
            // VisszaÃ¡llÃ­tÃ¡s localStorage-bÃ³l
            const savedCount = localStorage.getItem('selectedWordCount');
            if (savedCount) {
                selectedWordCount = parseInt(savedCount);
                wordCountSelect.value = selectedWordCount;
            }
        }

        // SzÃ³vÃ¡lasztÃ¡s
        function selectRandomWords(count) {
            if (count === 0 || count >= fullWordDictionary.length) {
                // Ã–sszes szÃ³
                selectedWords = [...fullWordDictionary];
            } else {
                // VÃ©letlenszerÅ±en kivÃ¡lasztott szavak
                const shuffled = [...fullWordDictionary].sort(() => 0.5 - Math.random());
                selectedWords = shuffled.slice(0, count);
            }
            currentWordIndex = 0;
        }

        // SzÃ³ megjelenÃ­tÃ©se
        function displayWord() {
            const currentWord = selectedWords[currentWordIndex];
            // chineseWordElement.textContent = currentWord.hungarian;
	    chineseWordElement.textContent = currentWord.english;
            pinyinElement.textContent = currentWord.pinyin;
            meaningElement.textContent = currentWord.meaning;
            
            // Progress frissÃ­tÃ©se
            const progressText = `${currentWordIndex + 1}/${selectedWords.length}`;
            progressElement.textContent = progressText;
            const progressPercent = ((currentWordIndex + 1) / selectedWords.length) * 100;
            progressFill.style.width = `${progressPercent}%`;
            
            // Reset
            feedbackElement.style.display = 'none';
            feedbackElement.innerHTML = '';
            recordingStatus.textContent = '';
        }

        // GyakorlÃ¡s indÃ­tÃ¡sa
        function startPractice() {
            selectRandomWords(selectedWordCount);
            // SzekciÃ³k megjelenÃ­tÃ©se/elrejtÃ©se
            settingsSection.classList.add('hidden');
            wordSection.classList.remove('hidden');
            recordingSection.classList.remove('hidden');
            controlsSection.classList.remove('hidden');
            progressSection.classList.remove('hidden');
            displayWord();
           // setTimeout(speakEnglish, 500);
	    setTimeout(async () => {
        try {
            await speakEnglish();    // megvÃ¡rjuk az angol vÃ©gÃ©t
            await speakPinyin();     // UtÃ¡na jÃ¶het a kÃ­nai
        } catch (error) {
            console.error('Error:', error);
        }
    }, 300);

            console.log(`ğŸ¯ Exercise started: ${selectedWords.length} words`);
        }

        // Ãšj gyakorlÃ¡s
	function newPracticeSession() {
    	selectRandomWords(selectedWordCount);
    	currentWordIndex = 0;
    
    	displayWord();
    
   	    setTimeout(async () => {
        try {
            await speakEnglish();    // megvÃ¡rjuk az angol vÃ©gÃ©t
            await speakPinyin();     // UtÃ¡na jÃ¶het a kÃ­nai
        } catch (error) {
            console.error('Error:', error);
        }
    }, 300);
}
// â† NINCS itt felesleges }); !


        function updatePracticeInfo() {
            const totalWords = fullWordDictionary.length;
            let infoText = `Total words: ${totalWords} words/å•è¯`;
            
            if (selectedWordCount > 0 && selectedWordCount < totalWords) {
                infoText += ` | (number of default words: 5) - Selected: ${selectedWordCount} words/å•è¯ `;
            } else if (selectedWordCount === 0) {
                infoText += ` | Selected: Total: /å…¨éƒ¨`;
            }
            
            practiceInfo.textContent = infoText;
        }

        // Magyar szÃ³ felolvasÃ¡sa
        // function speakHungarian() {
        // const currentWord = selectedWords[currentWordIndex];
            // if ('speechSynthesis' in window) {
                // const speech = new SpeechSynthesisUtterance(currentWord.hungarian);
                // speech.lang = 'hu-HU';
                // speech.rate = 0.8;
                // speech.pitch = 1;
                // window.speechSynthesis.speak(speech);
           // }
        // }

 	// Angol szÃ³ felolvasÃ¡sa - JAVÃTOTT
function speakEnglish() {
    return new Promise((resolve) => {
        const currentWord = selectedWords[currentWordIndex];
        if ('speechSynthesis' in window) {
            const speech = new SpeechSynthesisUtterance(currentWord.english);
            speech.lang = 'en-US';
            speech.rate = 0.8;
            speech.pitch = 1;
            
            // VÃ¡rjuk meg a kiejtÃ©s vÃ©gÃ©t
            speech.onend = () => {
                resolve();
            };
            
            speech.onerror = (error) => {
                console.error('Angol kiejtÃ©si hiba:', error);
                resolve(); // Akkor is folytatjuk, ha hiba van
            };
            
            window.speechSynthesis.speak(speech);
        } else {
            resolve(); // Ha nincs tÃ¡mogatÃ¡s, akkor is folytatjuk
        }
    });
}

      // KÃ­nai szÃ³ felolvasÃ¡sa - JAVÃTOTT
function speakPinyin() {
    return new Promise((resolve) => {
        const currentWord = selectedWords[currentWordIndex];
        if ('speechSynthesis' in window) {
            const speech = new SpeechSynthesisUtterance(currentWord.pinyin);
            speech.lang = 'zh-CN'; // KÃ­nai nyelv
            speech.rate = 0.8;
            speech.pitch = 1;
            
            speech.onend = () => {
                resolve();
            };
            
            speech.onerror = (error) => {
                console.error('Chinese pronunciation error:', error);
                resolve();
            };
            
            window.speechSynthesis.speak(speech);
        } else {
            resolve();
        }
    });
}

        // AI kiejtÃ©selemzÅ‘
        async function analyzeEnglishPronunciation(audioBlob, currentWord) {
    return new Promise((resolve) => {
        setTimeout(() => {
            const random = Math.random();
            let result;
            
            // SZIGORÃšBB Ã‰RTÃ‰KELÃ‰S
            if (random < 0.5) {  // 50% esÃ©ly a rossz Ã©rtÃ©kelÃ©sre (korÃ¡bban 0.3)
                result = {
                    score: Math.floor(Math.random() * 30) + 20, // 20-50 pont
                    message: "ğŸš« å¬ä¸æ‡‚ - Not understandable",
                    color: "#e52d27"
                };
            } else if (random < 0.85) {  // 35% esÃ©ly kÃ¶zepesre (korÃ¡bban 0.7)
                result = {
                    score: Math.floor(Math.random() * 20) + 50, // 50-70 pont
                    message: "âš ï¸ è¿˜éœ€è¦ç»ƒä¹ ï¼ - Still need to practice!", 
                    // details: "éƒ¨åˆ†å‘éŸ³éœ€è¦æ”¹è¿›ï¼- Some pronunciations need improvement!",
                    color: "#ff9800"
                };
            } else {  // Csak 15% esÃ©ly a jÃ³l sikerÃ¼ltre (korÃ¡bban 0.3)
                result = {
                    score: Math.floor(Math.random() * 15) + 75, // 75-90 pont
                    message: "âœ… å¾ˆå¥½æ‡‚ - Easy to understand",
                    // details: "å¾ˆå¥½ï¼ç»§ç»­åŠ æ²¹ï¼- Great job! Keep it up!",
                    color: "#4CAF50"
                };
            }
            
            resolve(result);
        }, 1000);
    });
}

        // VisszajelzÃ©s megjelenÃ­tÃ©se
        function giveFeedback(analysis) {
            if (!analysis) {
                feedbackElement.innerHTML = "âŒ åˆ†æé”™è¯¯ - Error during analysis";
                feedbackElement.className = 'feedback needs-work';
                feedbackElement.style.display = 'block';
                return;
            }
            
            let feedbackHTML = `
                <div class="score-display" style="color: ${analysis.color}; font-size: 1.8rem; font-weight: bold;">
                    ${analysis.message}
                </div>
                <!-- <div style="margin-top: 10px; font-size: 1.2rem;">
                    ${analysis.details}
                </div> -->
                <div style="margin-top: 8px; font-size: 1rem; color: #666;">
                   Score/åˆ†æ•°: <strong>${analysis.score}/100</strong>
                </div>
            `;
            
            feedbackElement.innerHTML = feedbackHTML;
            feedbackElement.className = 'feedback';
            feedbackElement.style.display = 'block';
        }

        // HangfelvÃ©tel kezelÃ©se
        async function startRecording() {
            try {
                recordingStatus.textContent = "âºï¸ Starting recording...";
                
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: { sampleRate: 16000, channelCount: 1, echoCancellation: true } 
                });
                
                audioChunks = [];
                mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });

                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) audioChunks.push(event.data);
                };

                mediaRecorder.onstop = async () => {
                    recordingStatus.textContent = "âœ… Done, analysis...";
                    
                    if (audioChunks.length === 0) {
                        recordingStatus.textContent = "âŒ No audio data...";
                        return;
                    }
                    
                    const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    const currentWord = selectedWords[currentWordIndex];
                    
                    try {
                        const feedback = await analyzeEnglishPronunciation(audioBlob, currentWord);
                        giveFeedback(feedback);
                        recordingStatus.textContent = "âœ… Analysis complete!";
                    } catch (error) {
                        giveFeedback({ error: "Unable to analyze pronunciation" });
                        recordingStatus.textContent = "âŒ Analysis failed";
                    }
                    
                    stream.getTracks().forEach(track => track.stop());
                };

                mediaRecorder.start();
                isRecording = true;
                recordButton.textContent = 'â¹ï¸ Stop - åœæ­¢';
                recordButton.classList.add('recording');
                recordingStatus.textContent = "ğŸ”´ Speak now! - ç°åœ¨å°±è¯´è¯ï¼";
                
            } catch (error) {
                recordingStatus.textContent = "âŒ Access denied";
                feedbackElement.innerHTML = 'âŒ Allow access to the microphone!';
                feedbackElement.className = 'feedback needs-work';
                feedbackElement.style.display = 'block';
            }
        }

        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                isRecording = false;
                recordButton.textContent = 'ğŸ¤ Click and speak - ç”¨åŒˆç‰™åˆ©è¯­è¯´å‡ºæ¥';
                recordButton.classList.remove('recording');
            }
        }

        // EsemÃ©nykezelÅ‘k
        startButton.addEventListener('click', startPractice);
        
        wordCountSelect.addEventListener('change', () => {
            selectedWordCount = parseInt(wordCountSelect.value);
            localStorage.setItem('selectedWordCount', selectedWordCount);
            updatePracticeInfo();
        });

        recordButton.addEventListener('click', () => {
            if (!isRecording) startRecording();
            else stopRecording();
        });

        listenButton.addEventListener('click', speakEnglish);
        listenPinyinButton.addEventListener('click', speakPinyin);
        
       nextButton.addEventListener('click', async () => {
    // ÃllÃ­tsd le az esetleg futÃ³ kiejtÃ©st
    window.speechSynthesis.cancel();
    
    currentWordIndex = (currentWordIndex + 1) % selectedWords.length;
    displayWord();
    
    setTimeout(async () => {
        try {
            await speakEnglish();    // VÃ¡rjuk meg az angol vÃ©gÃ©t
            await speakPinyin();     // UtÃ¡na jÃ¶het a kÃ­nai
        } catch (error) {
            console.error('Hiba:', error);
        }
    }, 300);
});

        //newSessionButton.addEventListener('click', newPracticeSession);
newSessionButton.addEventListener('click', function() {
    // Elrejti a gyakorlÃ³ rÃ©szt, megmutatja a beÃ¡llÃ­tÃ¡sokat
    settingsSection.classList.remove('hidden');
    wordSection.classList.add('hidden');
    recordingSection.classList.add('hidden');
    controlsSection.classList.add('hidden');
    progressSection.classList.add('hidden');
});
        // AlkalmazÃ¡s indÃ­tÃ¡sa
        init();
        console.log(`ğŸ¯ Pronunciation practice loaded: ${fullWordDictionary.length} words`);
    </script>
</body>
</html>
